@{
    ViewBag.Title = "PA Community";
    Layout = "~/Views/Shared/_MasterApplication.cshtml";
}
<style>
    .bgButton {
        text-align: center;
        background-color: #337ab7;
        cursor: pointer;
        /*height: 69px;*/
        position: fixed;
        bottom: 0;
        left: 0;
        margin-top: 50px;
    }
</style>
<div class="container-fluid">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 bg-primary text-white">
            <h3>ข้อมูล Application ชุมชน</h3>
        </div>
    </div>
    <br />
    <form class="form-horizontal" action="@Url.Action("AddPACommunity")" method="post">
        <fieldset>
            <div class="container-fluid">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="input_AppID">Application ID:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <input type="text" name="input_AppID" id="input_AppID" class="form-control" value="@ViewBag.AppID" readonly="readonly" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="input_AgentID">รหัสตัวแทน:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <input type="text" name="input_AgentID" id="input_AgentID" class="form-control" value="@ViewBag.agentId" readonly="readonly" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="input_coverDate">งวดความคุ้มครอง:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <input type="text" name="input_coverDate" id="input_coverDate" class="form-control" value="@ViewBag.StartCoverDate" readonly="readonly" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="input_AppCardID">เลขบัตรประกัน:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <input type="text" name="input_AppCardID" id="input_AppCardID" class="form-control" value="@ViewBag.cardNo" @(ViewBag.cardNo != null ? "readonly" : "") />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="">คำนำหน้า:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <select name="select_title" id="select_title" class="form-control select2" disabled="disabled">
                                    @foreach (var item in ViewBag.TitleName)
                                    {
                                        <option value="@item.TempCode" @(item.TempCode == ViewBag.obj.Title_id ? "selected" : "")>@item.TitleDetail</option>
                                    }
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="input_firstname">ชื่อ:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <input type="text" name="input_firstname" id="input_firstname" class="form-control" value="@ViewBag.firstname" readonly="readonly" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="input_surename">นามสกุล:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <input type="text" name="input_surename" id="input_surename" class="form-control" value="@ViewBag.lastname" readonly="readonly" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="select_sex">เพศ:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <select name="select_sex" id="select_sex" class="form-control select2">
                                    @foreach (var item in ViewBag.Sex)
                                    {
                                        <option value="@item.SexCode" @(item.SexCode == ViewBag.obj.Sex_id ? "selected" : "")>@item.SexDetail</option>
                                    }
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="input_zcardID">เลขบัตรประชาชน:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <input type="text" name="input_zcardID" id="input_zcardID" class="form-control" value="@ViewBag.zCardID" @(ViewBag.zCardID != null ? "readonly" : "") />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="input_passport">เลขPassport:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <input type="text" name="input_passport" id="input_passport" class="form-control" value="@ViewBag.passport" @(ViewBag.passport != null ? "readonly" : "") />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="input_birthDate">วันเกิด:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <input type="text" name="input_birthDate" id="input_birthDate" class="form-control" value="@ViewBag.birthDate" readonly="readonly" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="select_occupation">อาชีพ:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <select name="select_occupation" id="select_occupation" class="form-control select2 checkNA">
                                    @foreach (var item in ViewBag.Occupation)
                                    {
                                        <option value="@item.OccupationCode" @(item.OccupationCode == ViewBag.obj.Occupation_id ? "selected" : "")>@item.OccupationDetail</option>
                                    };
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="selec_occupationlevel">ระดับอาชีพ:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <select name="selec_occupationlevel" id="selec_occupationlevel" class="form-control select2 checkNA">
                                    @* get occupation level *@
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="input_mobile">เบอร์โทรศัพท์:</label>
                            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <input type="number" name="input_mobile" id="input_mobile" class="form-control" value="@ViewBag.mobileNo" required="required" />
                            </div>
                        </div>
                    </div>
                </div>
                <br />
                @* zcardid address *@
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7" style="text-align: center">
                                <div class="btn-group">
                                    @if (ViewBag.ContactAddress.AddressFullDetail != null)
                                    {
                                        <button type="button" id="btnEdit" name="btnEdit" data-toggle="modal" href="#modal-id" class="btn btn-info">แก้ไข</button>
                                    }
                                    else
                                    {
                                        <button type="button" id="btnCard_address" name="btnCard_address" data-toggle="modal" href="#modal-id" class="btn btn-success">เพิ่ม</button>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-lg-12">
                        <div class="form-group form-group-lg">
                            <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3" for="">ที่อยู่ติดต่อ</label>
                            <div class="col-sm-7 col-lg-7">
                                <input id="card_address" name="card_address" class="form-control" value="@ViewBag.ContactAddress.AddressFullDetail" readonly="readonly" required="required">
                            </div>
                        </div>
                    </div>
                </div>
                @if (TempData["Message"] != null)
                {
                    <div class="row">
                        <div class="col-xs-12 col-sm-12 col-lg-12">
                            <div class="form-group form-group-lg">
                                <label class="control-label col-xs-3 col-sm-3 col-md-3 col-lg-3 alert-danger">@ViewBag.message</label>
                            </div>
                        </div>
                    </div>
                }
                <!-- element ที่ซ่อนไว้เพื่อใช้เก็บค่า-->
                <input type="hidden" id="cur_AddressID" name="cur_AddressID" value="@ViewBag.addressID" />
                <input type="hidden" id="hidden_districtId" name="hidden_districtId" />
                <input type="hidden" id="hidden_subdistrictId" name="hidden_subdistrictId" />
                <input type="hidden" id="hidden_AppId" name="hidden_AppId" />
                <input type="hidden" id="hidden_addressType" name="hidden_addressType" value="2" />
                <input type="hidden" id="hidden_occupationLevelId" name="hidden_occupationLevelId" />
                <input type="hidden" id="hidden_CreateById" name="hidden_CreateById" value="@ViewBag.createby" />
                <input type="hidden" id="hidden_titleName" name="hidden_titleName" />
                <input type="hidden" id="hidden_contactAddressId" name="hidden_contactAddressId" value="@ViewBag.contactAddressId" />
                <hr />
                <hr />
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 bgButton">
                        <button type="submit" class="btnNext" style="width: 100%">บันทึกข้อมูล</button>
                    </div>
                </div>
            </div>
        </fieldset>
    </form>
</div>

<!--Modal-->
<form class="form-horizontal" id="modal-Address">
    <div class="modal fade" id="modal-id">
        <div class="modal-dialog ">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                    <h4 class="modal-title">ที่อยู่</h4>
                </div>
                <div class="modal-body">
                    <fieldset>
                        @*<div class="row">
                                <div class="col-sm-12 col-lg-12">
                                    <div class="form-group form-group-lg">
                                        <label class="col-lg-3 control-label" for="select_typeaddress">ประเภทที่อยู่</label>
                                        <div class="col-lg-8">
                                            <select name="select_typeaddress" id="select_typeaddress" class="form-control select2" style="width: 100%">
                                                @foreach (var item in ViewBag.AddressType)
                                                {
                                                    <option value="@item.AddressType_ID">@item.AddressTypeDetail</option>
                                                }
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>*@
                        <div class="row">
                            <div class="col-sm-12 col-lg-12">
                                <div class="form-group form-group-lg">
                                    <label class="col-sm-3 col-lg-3 control-label" for="modal_division">หน่วยงาน</label>
                                    <div class="col-sm-8 col-lg-8">
                                        <input type="text" id="modal_division" name="modal_division" class="form-control"
                                               placeholder="หน่วยงาน">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-12 col-lg-12">
                                <div class="form-group form-group-lg">
                                    <label class="col-sm-3 col-lg-3 control-label" for="modal_village">หมู่บ้าน</label>
                                    <div class="col-sm-8 col-lg-8">
                                        <input type="text" id="modal_village" name="modal_village" class="form-control"
                                               placeholder="หมู่บ้าน">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12 col-lg-12">
                                <div class="form-group form-group-lg">
                                    <label class="col-sm-3 col-lg-3 control-label" for="modal_no">เลขที่</label>
                                    <div class="col-sm-8 col-lg-8">
                                        <input type="text" id="modal_no" name="modal_no" class="form-control"
                                               placeholder="หมู่เลขที่" required="required">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12 col-lg-12">
                                <div class="form-group form-group-lg">
                                    <label class="col-sm-3 col-lg-3 control-label" for="modal_moo">หมู่ที่</label>
                                    <div class="col-sm-8 col-lg-8">
                                        <input type="text" id="modal_moo" name="modal_moo" class="form-control"
                                               placeholder="หมู่ที่" required="required">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12 col-lg-12">
                                <div class="form-group form-group-lg">
                                    <label class="col-sm-3 col-lg-3 control-label" for="modal_floor">ชั้น</label>
                                    <div class="col-sm-8 col-lg-8">
                                        <input type="text" id="modal_floor" name="modal_floor" class="form-control"
                                               placeholder="ชั้น">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12 col-lg-12">
                                <div class="form-group form-group-lg">
                                    <label class="col-sm-3 col-lg-3 control-label" for="modal_road">ถนน</label>
                                    <div class="col-sm-8 col-lg-8">
                                        <input type="text" id="modal_road" name="modal_road" class="form-control"
                                               placeholder="ถนน">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12 col-lg-12">
                                <div class="form-group form-group-lg">
                                    <label class="col-sm-3 col-lg-3 control-label" for="modal_alley">ซอย</label>
                                    <div class="col-sm-8 col-lg-8">
                                        <input type="text" id="modal_alley" name="modal_alley" class="form-control"
                                               placeholder="ซอย">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12 col-lg-12">
                                <div class="form-group form-group-lg">
                                    <label class="col-sm-3 col-lg-3 control-label" for="modal_province">จังหวัด</label>
                                    <div class="col-sm-8 col-lg-8">
                                        <select name="modal_province" id="modal_province" class="form-control select2 checkNA" style="width: 100%">
                                            @foreach (var item in ViewBag.ProvinceList)
                                            {
                                                <option value="@item.Province_ID" )>@item.ProvinceDetail</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12 col-lg-12">
                                <div class="form-group form-group-lg">
                                    <label class="col-sm-3 col-lg-3 control-label" for="modal_district">อำเภอ</label>
                                    <div class="col-sm-8 col-lg-8">
                                        <select name="modal_district" id="modal_district" class="form-control select2 checkNA" style="width: 100%"></select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12 col-lg-12">
                                <div class="form-group form-group-lg">
                                    <label class="col-sm-3 col-lg-3 control-label" for="modal_subdistrict">ตำบล</label>
                                    <div class="col-sm-8 col-lg-8">
                                        <select name="modal_subdistrict" id="modal_subdistrict" class="form-control select2 checkNA" style="width: 100%"></select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-12 col-lg-12">
                                <div class="form-group form-group-lg">
                                    <label class="col-sm-3 col-lg-3 control-label" for="modal_zipcode">รหัสไปรษณีย์</label>
                                    <div class="col-sm-8 col-lg-8">
                                        <input type="number" value="" name="modal_zipcode" id="modal_zipcode" class="form-control" placeholder="รหัสไปรษณีย์" required="" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </div>
                <div class="modal-footer">
                    <div class="clearfix "></div>
                    <div class="row">
                        <div class="col-sm-12 col-lg-12">
                            <div class="form-group form-group-lg">
                                <div class="col-xs-6 col-sm-6  col-md-6 col-lg-6  Asetmarginformcontrol">
                                    @*<button type="submit" class="btn btn-primary" id="modal_save">Save</button>*@
                                    <button type="button" class="btn btn-primary" name="modal_save" id="modal_save">Save</button>
                                </div>
                                <div class="col-xs-6 col-sm-6  col-md-6 col-lg-6  Asetmarginformcontrol setleftt">
                                    <button type="button" class="btn btn-default" name="modal_close" id="modal_close" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>

@section scripts
{
    <script type="text/javascript">
        $(function () {
            GetPAApplicationDetail();
            GetOccupationLevel($('#select_occupation').val());
            GetDistrict($('#modal_province').val());

            //occupation change
            $('#select_occupation').change(function (e) {
                debugger;
                GetOccupationLevel($('#select_occupation').val());
                $('#hidden_occupationLevelId').val('');
            });

            //province change
            $('#modal_province').change(function () {
                $('#hidden_districtId').val("");
                $('#hidden_subdistrictId').val("");
                GetDistrict($('#modal_province').val());
            });

            //district change
            $('#modal_district').change(function () {
                //debugger;
                $('#hidden_subdistrictId').val("");
                GetSubDistrict($('#modal_district').val());

            });

            //subdistrict change
            $('#modal_subdistrict').change(function () {
                GetZipCode($('#modal_subdistrict').val());
            });

            //change keyup
            $('#input_zcardID').on("change paste keyup",
                function () {
                    //Call method Check identityCard
                    $('#input_zcardID').css("color", "black");
                    var idcard = $('#input_zcardID').val();
                    if (idcard.length == 13) {
                        if (CheckIdentityCard(idcard) == true) {
                            //alert("true");
                            $('#input_zcardID').css('color', 'green');
                        } else {
                            //alert("false");
                            $('#input_zcardID').css('color', 'red');
                            $('#input_zcardID').focus();
                        }
                    };
                });

            $('#btnCur_address').click(function () {
                $("#modal-Address").validate().resetForm();
                if ($('#cur_AddressID').val() != null || $('#cur_AddressID').val() != "") {
                    debugger;
                    GetModalAddress("2", $('#cur_AddressID').val()); //ที่ปัจจุบัน
                    $('#hidden_addressType').val("2");
                } else {
                    $('#select_typeaddress').val("2").trigger('change');
                }
            });

            $('#btnEdit').click(function () {
                $("#modal-Address").validate().resetForm();
                if ($('#cur_AddressID').val() != null || $('#cur_AddressID').val() != "") {
                    GetModalAddress("2", "@ViewBag.obj.ContactAddress_id"); //ที่ปัจจุบัน
                    $('#hidden_addressType').val("2");
                    GetPAApplicationDetail();

                } else {
                    $('#select_typeaddress').val("2").trigger('change');
                    GetPAApplicationDetail();
                }
            });

            //btnModalSave Click
            $('#modal_save').click(function () {
                debugger;
                if ($("#modal-Address").valid() == true) {
                    debugger;
                    SetAddress("2", $('#hidden_contactAddressId').val()); //curr address
                    $('#modal_close').click();
                };
            });

            //validate
            $("#modal-Address").validate();

        });

        function GetOccupationLevel(occupationId) {
            $.ajax({
                type: "GET",
                url: "@ViewBag.APIUrlApplication/MobileApi/Mobile/OccupationLevels?occupationCode=" + occupationId,
                //async: false, //ทำฟังก์ชั่นนี้ให้เสร็จก่อน
                success: function (response) {
                    debugger;
                    $('#selec_occupationlevel').empty();
                    for (var i = 0; i < response.length; i++) {
                        $('#selec_occupationlevel').append('<option value="' +
                            response[i].temp1 +
                            '">' +
                            response[i].occupationLevelDetail +
                            '</option>');
                    }

                    if ('@ViewBag.OccupationLevel' != '' && '@ViewBag.OccupationLevel' == $('#hidden_occupationLevelId').val()) {
                        $('#selec_occupationlevel').val('@ViewBag.OccupationLevel');
                    }

                }
            });
        }

        //get district
        function GetDistrict(provinceId) {
            $.ajax({
                type: "GET",
                url: "@ViewBag.APIUrlApplication/MobileApi/Address/District?provinceId=" + provinceId,
                //async: false, //ทำฟังก์ชั่นนี้ให้เสร็จก่อน
                success: function (response) {
                    $('#modal_district').empty();
                    for (var i = 0; i < response.length; i++) {
                        $('#modal_district').append('<option value="' +
                            response[i].district_ID +
                            '">' +
                            response[i].districtDetail +
                            '</option>');
                    }

                    if (provinceId != "9999999" && $('#hidden_districtId').val() != "") {
                        $('#modal_district').val($('#hidden_districtId').val());
                        GetSubDistrict($('#hidden_districtId').val());
                    } else {
                        GetSubDistrict(response[0].district_ID);
                    }

                }
            });
        }

        //get subdistrict
        function GetSubDistrict(districtId) {
            $.ajax({
                type: "GET",
                url: "@ViewBag.APIUrlApplication/MobileApi/Address/SubDistrict?districtId=" + districtId,
                success: function (response) {

                    $('#modal_subdistrict').empty();
                    for (var i = 0; i < response.length; i++) {
                        $('#modal_subdistrict').append('<option value="' +
                            response[i].subDistrict_ID +
                            '">' +
                            response[i].subDistrictDetail +
                            '</option>');
                    }

                    if (districtId != "9999999" && $('#hidden_subdistrictId').val() != "") {
                        $('#modal_subdistrict').val($('#hidden_subdistrictId').val());
                        //GetZipCode($('#hidden_subdistrictId').val());
                    } else {
                        $('#modal_zipcode').val(response[0].zipCode);
                    }
                }
            });
        }

        //get zipcode
        function GetZipCode(subDistrictId) {
            $.ajax({
                type: "GET",
                url: "@ViewBag.APIUrlApplication/MobileApi/Address/zipCode?SubDistrictid=" + subDistrictId,
                success: function (response2) {
                    $('#modal_zipcode').val(response2.zipCode);
                }
            });
        }

        function GetModalAddress(addressType, addressId) {
            //debugger;
            $('#select_typeaddress').val(addressType).trigger('change');
            $('#select_typeaddress').prop("disabled", true);
            $.ajax({
                type: "GET",
                url: "@ViewBag.APIUrlApplication/MobileApi/Address/AddressPH?addressId=" + addressId,
                success: function (response) {
                    $('#modal_division').val(response.buildingName);
                    $('#modal_village').val(response.villageName);
                    $('#modal_no').val(response.no);
                    $('#modal_moo').val(response.moo);
                    $('#modal_floor').val(response.floor);
                    $('#modal_road').val(response.road);
                    $('#modal_alley').val(response.soi);
                    if (response.province_id != null) {
                        $('#modal_province').val(response.province_id).trigger('change');
                    } else {
                        $('#modal_province').val("9999999").trigger('change');
                    }
                    if (response.amphoe_id != null) {
                        $('#hidden_districtId').val(response.amphoe_id);
                    }
                    if (response.tumbol_id != null) {
                        $('#hidden_subdistrictId').val(response.tumbol_id);
                    }

                    $('#modal_zipcode').val(response.zipCode);

                    switch (addressType) {
                        case "2":
                            $('#cur_address').val(response.addressFullDetail);
                            break;
                        case "3":
                            $('#card_address').val(response.addressFullDetail);
                            break;
                        case "4":
                            $('#work_address').val(response.addressFullDetail);
                            break;
                        default:
                            break;
                    }

                }
            });

        }

        //set address
        function SetAddress(addressType, addressId) {
            $.ajax({
                type: "POST",
                url: "@ViewBag.APIUrlApplication/MobileApi/Address/AddressPH",
                data: {
                    "addressId": addressId,
                    "buildingName": $('#modal_division').val(),
                    "villageName": $('#modal_village').val(),
                    "no": $('#modal_no').val(),
                    "moo": $('#modal_moo').val(),
                    "floor": $('#modal_floor').val(),
                    "soi": $('#modal_alley').val(),
                    "road": $('#modal_road').val(),
                    "subDistrictId": $('#modal_subdistrict').val(),
                    "updateById": $('#hidden_CreateById').val()
                },
                success: function (response) {
                    debugger;
                    //get address
                    GetModalAddress(addressType, response.address_ID);
                    GetFullAddressDetail(response.address_ID);
                    //location.reload();
                    GetPAApplicationDetail();

                },
                error: function (xhr, error) {
                    alert(xhr.responseText);
                }
            });
        }

        function GetPAApplicationDetail() {
            debugger;
            $('#input_AppID').val('@ViewBag.AppId');
            $('#input_AgentID').val('@ViewBag.agentId');
            $('#input_coverDate').val('@ViewBag.StartCoverDate');
            $('#input_AppCardID').val('@ViewBag.cardNo');
            $('#select_title').val('@ViewBag.titleId');
            $('#input_firstname').val('@ViewBag.firstname');
            $('#input_surename').val('@ViewBag.lastname');
            $('#select_sex').val(@ViewBag.SexId);
            $('#input_zcardID').val('@ViewBag.zCardID');
            $('#input_birthDate').val('@ViewBag.birthDate');
            $('#input_mobile').val('@ViewBag.mobileNo');
            if ($('#card_address') == null) {
                $('#card_address').val('@ViewBag.ContactAddress.AddressFullDetail');
            }
            $('#hidden_occupationLevelId').val('@ViewBag.OccupationLevel');
            $('#hidden_titleName').val('@ViewBag.titleId');
        }

        //Check id card
        function CheckIdentityCard(cardId) {
            if (cardId.length != 13) return false;
            var sum = 0;
            for (var i = 0; i < 12; i++) {
                sum += parseFloat(cardId.charAt(i)) * (13 - i);
            }
            if ((11 - (sum % 11)) % 10 != parseFloat(cardId.charAt(12))) {
                return false;
            }

            return true;
        }

        function GetFullAddressDetail(AddressId) {
            $.ajax({
                url: '@Url.Action("GetAddress")',
                data: {
                    addressId: AddressId
                },
                success: function (response) {
                    $('#card_address').val(response);
                }
            });
        }
    </script>
}