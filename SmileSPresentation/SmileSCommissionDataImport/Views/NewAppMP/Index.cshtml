@{
    ViewBag.Title = "NewApp MP";
    ViewBag.Description = "";
}
@if(ViewBag.isInvalidColumn == true)
{
    <div class="alert alert-danger alert-dismissible">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
        <h4><i class="icon fa fa-ban"></i> Error!</h4>
        @ViewBag.isInvalidMsg
    </div>
}
<div class="row">
    <div class="col-xs-12 col-md-12">
        <div class="box box-default">
            <div class="box-header">
                <h3 class="box-title">ชื่อไฟล์</h3>
            </div>
            @using(Html.BeginForm("Upload","NewAppMP",FormMethod.Post,new { id = "upload_form",enctype = "multipart/form-data" }))
            {
                <div class="box-body">
                    <div id="form_upload" class="form-group">
                        <label for="input_file">กรุณาเลือกไฟล์ที่ต้องการอัพโหลด</label>
                        <input type="file" name="file" id="input_file">
                        <p class="help-block">*ไฟล์ .xls .xlsx</p>
                    </div>
                </div>
                <div class="box-footer">
                    <div onclick="upload_file()" class="btn btn-primary">อัพโหลด</div>
                    @*<a class="btn btn-default" href="~/Content/excel_example/Zebra.xlsx">ไฟล์ตัวอย่าง</a>*@
                    <button type="button" id="btnNoData" class="pull-right btn btn-danger">No Data</button>
                </div>
            }
        </div>
    </div>
</div>
@*<p>@ViewBag.ValidJson</p>
    <p>@ViewBag.InvalidJson</p>*@
@if(ViewBag.Valid.Count > 0)
{
    <div class="row">
        <div class="col-xs-12">
            <div class="box box-success">
                <div class="box-header">
                    <h3 class="box-title">ข้อมูลที่ถูกต้องตามเงื่อนไข</h3>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    <div id="example2_wrapper" class="dataTables_wrapper form-inline dt-bootstrap">
                        <div class="row"><div class="col-sm-6"></div><div class="col-sm-6"></div></div><div class="row">
                            <div class="col-sm-12">
                                <table id="table_valid" class="table table-bordered table-hover dataTable" role="grid">
                                    <thead>
                                        <tr role="row">
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">AppID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Status</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ContractTypeDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">StartCover</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">StartCover_D</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">StartCover_M</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">StartCover_Y</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">EndCover</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">EndCover_D</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">EndCover_M</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">EndCover_Y</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ProductType_ID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ProductTypeDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Product_ID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ProductDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PremiumPerMonth</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PremiumPerYear</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PeriodType_ID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PeriodTypeDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">CustName</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerName</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerDistrictID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerDistrict</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerProvinceID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerProvince</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerBranch_ID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerBranchDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerStudyArea_Id</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerStudyArea</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Sale1_Employee_Code</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">SaleName</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Sale1_Branch_ID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Sale1_BranchDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ZebraCar_Code</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ZebraCar_No</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ZebraCarOwner_Id</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">VehicleRegistrationDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">VehicleRegistrationNumber</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">VehicleRegistrationProvince</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">CreateBy_Employee_Code</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ApproveBy_Employee_Code</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">SaleID2</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">CreatedDate</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">CreatedDate_D</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">CreatedDate_M</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">CreatedDate_Y</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ApproveDate</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ApproveDate_D</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ApproveDate_M</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ApproveDate_Y</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">SaleID_Service</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">SaleName_Service</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">SaleID_NewAppShare</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">SaleName_NewAppShare</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Policy_Issued_Date</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Insured_Title</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Insured_First_Name</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Insured_Last_Name</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Payer_Title</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Payer_First_Name</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Payer_Last_Name</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Premium</div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach(var item in ViewBag.Valid)
                                        {
                                            <tr role="row" class="odd">
                                                <td>@item.AppID</td>
                                                <td>@item.Status</td>
                                                <td>@item.ContractTypeDetail</td>
                                                <td>@(item.StartCover != null ? item.StartCover.ToString("dd/MM/yyyy") : "")</td>
                                                <td>@item.StartCover_D</td>
                                                <td>@item.StartCover_M</td>
                                                <td>@item.StartCover_Y</td>
                                                <td>@(item.EndCover != null ? item.EndCover.ToString("dd/MM/yyyy") : "")</td>
                                                <td>@item.EndCover_D</td>
                                                <td>@item.EndCover_M</td>
                                                <td>@item.EndCover_Y</td>
                                                <td>@item.ProductType_ID</td>
                                                <td>@item.ProductTypeDetail</td>
                                                <td>@item.Product_ID</td>
                                                <td>@item.ProductDetail</td>
                                                <td>@item.PremiumPerMonth</td>
                                                <td>@item.PremiumPerYear</td>
                                                <td>@item.PeriodType_ID</td>
                                                <td>@item.PeriodTypeDetail</td>
                                                <td>@item.CustName</td>
                                                <td>@item.PayerName</td>
                                                <td>@item.PayerDistrictID</td>
                                                <td>@item.PayerDistrict</td>
                                                <td>@item.PayerProvinceID</td>
                                                <td>@item.PayerProvince</td>
                                                <td>@item.PayerBranch_ID</td>
                                                <td>@item.PayerBranchDetail</td>
                                                <td>@item.PayerStudyArea_Id</td>
                                                <td>@item.PayerStudyArea</td>
                                                <td>@item.Sale1_Employee_Code</td>
                                                <td>@item.SaleName</td>
                                                <td>@item.Sale1_Branch_ID</td>
                                                <td>@item.Sale1_BranchDetail</td>
                                                <td>@item.ZebraCar_Code</td>
                                                <td>@item.ZebraCar_No</td>
                                                <td>@item.ZebraCarOwner_Id</td>
                                                <td>@item.VehicleRegistrationDetail</td>
                                                <td>@item.VehicleRegistrationNumber</td>
                                                <td>@item.VehicleRegistrationProvince</td>
                                                <td>@item.CreateBy_Employee_Code</td>
                                                <td>@item.ApproveBy_Employee_Code</td>
                                                <td>@item.SaleID2</td>
                                                <td>@(item.CreatedDate != null ? item.CreatedDate.ToString("dd/MM/yyyy") : "")</td>
                                                <td>@item.CreatedDate_D</td>
                                                <td>@item.CreatedDate_M</td>
                                                <td>@item.CreatedDate_Y</td>
                                                <td>@(item.ApproveDate != null ? item.ApproveDate.ToString("dd/MM/yyyy") : "")</td>
                                                <td>@item.ApproveDate_D</td>
                                                <td>@item.ApproveDate_M</td>
                                                <td>@item.ApproveDate_Y</td>
                                                <td>@item.SaleID_Service</td>
                                                <td>@item.SaleName_Service</td>
                                                <td>@item.SaleID_NewAppShare</td>
                                                <td>@item.SaleName_NewAppShare</td>
                                                <td>@(item.Policy_Issued_Date != null ? item.Policy_Issued_Date.ToString("dd/MM/yyyy") : "")</td>
                                                <td>@item.Insured_Title</td>
                                                <td>@item.Insured_First_Name</td>
                                                <td>@item.Insured_Last_Name</td>
                                                <td>@item.Payer_Title</td>
                                                <td>@item.Payer_First_Name</td>
                                                <td>@item.Payer_Last_Name</td>
                                                <td>@item.Premium</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /.box-body -->
            </div>
            <!-- /.box -->
        </div>
        <!-- /.col -->
    </div>
}
@if(ViewBag.Invalid.Count > 0)
{
    <div class="row">
        <div class="col-xs-12">
            <div class="box box-danger">
                <div class="box-header">
                    <h3 class="box-title">ข้อมูลที่มีปัญหา</h3>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    <div id="example2_wrapper" class="dataTables_wrapper form-inline dt-bootstrap">
                        <div class="row"><div class="col-sm-6"></div><div class="col-sm-6"></div></div><div class="row">
                            <div class="col-sm-12">
                                <table id="table_invalid" class="table table-bordered table-hover dataTable" role="grid">
                                    <thead>
                                        <tr role="row">
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 200px; text-align: center;">Error</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">AppID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Status</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ContractTypeDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">StartCover</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">StartCover_D</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">StartCover_M</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">StartCover_Y</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">EndCover</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">EndCover_D</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">EndCover_M</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">EndCover_Y</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ProductType_ID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ProductTypeDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Product_ID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ProductDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PremiumPerMonth</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PremiumPerYear</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PeriodType_ID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PeriodTypeDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">CustName</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerName</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerDistrictID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerDistrict</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerProvinceID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerProvince</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerBranch_ID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerBranchDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerStudyArea_Id</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">PayerStudyArea</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Sale1_Employee_Code</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">SaleName</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Sale1_Branch_ID</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Sale1_BranchDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ZebraCar_Code</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ZebraCar_No</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ZebraCarOwner_Id</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">VehicleRegistrationDetail</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">VehicleRegistrationNumber</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">VehicleRegistrationProvince</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">CreateBy_Employee_Code</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ApproveBy_Employee_Code</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">SaleID2</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">CreatedDate</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">CreatedDate_D</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">CreatedDate_M</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">CreatedDate_Y</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ApproveDate</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ApproveDate_D</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ApproveDate_M</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">ApproveDate_Y</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">SaleID_Service</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">SaleName_Service</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">SaleID_NewAppShare</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">SaleName_NewAppShare</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Policy_Issued_Date</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Insured_Title</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Insured_First_Name</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Insured_Last_Name</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Payer_Title</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Payer_First_Name</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Payer_Last_Name</div>
                                            </th>
                                            <th class="sorting" tabindex="0" rowspan="1" colspan="1">
                                                <div style="min-width: 100px; text-align: center;">Premium</div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach(var item in ViewBag.Invalid)
                                        {
                                            <tr role="row" class="odd">
                                                <td>
                                                    @foreach(var err in item.InvalidList)
                                                    {
                                                        <p style="color: red;">- @err</p>
                                                    }
                                                </td>
                                                <td>@item.AppID</td>
                                                <td>@item.Status</td>
                                                <td>@item.ContractTypeDetail</td>
                                                <td>@(item.StartCover != null ? item.StartCover.ToString("dd/MM/yyyy") : "")</td>
                                                <td>@item.StartCover_D</td>
                                                <td>@item.StartCover_M</td>
                                                <td>@item.StartCover_Y</td>
                                                <td>@(item.EndCover != null ? item.EndCover.ToString("dd/MM/yyyy") : "")</td>
                                                <td>@item.EndCover_D</td>
                                                <td>@item.EndCover_M</td>
                                                <td>@item.EndCover_Y</td>
                                                <td>@item.ProductType_ID</td>
                                                <td>@item.ProductTypeDetail</td>
                                                <td>@item.Product_ID</td>
                                                <td>@item.ProductDetail</td>
                                                <td>@item.PremiumPerMonth</td>
                                                <td>@item.PremiumPerYear</td>
                                                <td>@item.PeriodType_ID</td>
                                                <td>@item.PeriodTypeDetail</td>
                                                <td>@item.CustName</td>
                                                <td>@item.PayerName</td>
                                                <td>@item.PayerDistrictID</td>
                                                <td>@item.PayerDistrict</td>
                                                <td>@item.PayerProvinceID</td>
                                                <td>@item.PayerProvince</td>
                                                <td>@item.PayerBranch_ID</td>
                                                <td>@item.PayerBranchDetail</td>
                                                <td>@item.PayerStudyArea_Id</td>
                                                <td>@item.PayerStudyArea</td>
                                                <td>@item.Sale1_Employee_Code</td>
                                                <td>@item.SaleName</td>
                                                <td>@item.Sale1_Branch_ID</td>
                                                <td>@item.Sale1_BranchDetail</td>
                                                <td>@item.ZebraCar_Code</td>
                                                <td>@item.ZebraCar_No</td>
                                                <td>@item.ZebraCarOwner_Id</td>
                                                <td>@item.VehicleRegistrationDetail</td>
                                                <td>@item.VehicleRegistrationNumber</td>
                                                <td>@item.VehicleRegistrationProvince</td>
                                                <td>@item.CreateBy_Employee_Code</td>
                                                <td>@item.ApproveBy_Employee_Code</td>
                                                <td>@item.SaleID2</td>
                                                <td>@(item.CreatedDate != null ? item.CreatedDate.ToString("dd/MM/yyyy") : "")</td>
                                                <td>@item.CreatedDate_D</td>
                                                <td>@item.CreatedDate_M</td>
                                                <td>@item.CreatedDate_Y</td>
                                                <td>@(item.ApproveDate != null ? item.ApproveDate.ToString("dd/MM/yyyy") : "")</td>
                                                <td>@item.ApproveDate_D</td>
                                                <td>@item.ApproveDate_M</td>
                                                <td>@item.ApproveDate_Y</td>
                                                <td>@item.SaleID_Service</td>
                                                <td>@item.SaleName_Service</td>
                                                <td>@item.SaleID_NewAppShare</td>
                                                <td>@item.SaleName_NewAppShare</td>
                                                <td>@(item.Policy_Issued_Date != null ? item.Policy_Issued_Date.ToString("dd/MM/yyyy") : "")</td>
                                                <td>@item.Insured_Title</td>
                                                <td>@item.Insured_First_Name</td>
                                                <td>@item.Insured_Last_Name</td>
                                                <td>@item.Payer_Title</td>
                                                <td>@item.Payer_First_Name</td>
                                                <td>@item.Payer_Last_Name</td>
                                                <td>@item.Premium</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /.box-body -->
            </div>
            <!-- /.box -->
        </div>
        <!-- /.col -->
    </div>
}
@if(ViewBag.Valid.Count > 0 && ViewBag.Invalid.Count == 0)
{
    <div class="row">
        <div class="col-xs-12 col-md-12">
            <div class="box box-default">
                <div class="box-footer">
                    @*@using (Html.BeginForm("Save", "Home", FormMethod.Post, new { id = "upload_form", enctype = "multipart/form-data" }))
                        {
                            <input type="hidden" name="valid" value="@ViewBag.ValidJson" />
                            <input type="hidden" name="invalid" value="@ViewBag.InvalidJson" />

                            <button type="submit" class="btn btn-primary">บันทึกข้อมูล</button>
                        }*@
                    <button onclick="save()" class="btn btn-primary">บันทึกข้อมูล</button>
                </div>
            </div>
        </div>
    </div>
}
@section ViewSpecificJavascript {
    <script>

        $(document).ready(function () {
            $('#table_valid').DataTable({
                "scrollX": true
            });
            $('#table_invalid').DataTable({
                "scrollX": true
            });
             $('#btnNoData').click((e) => {
                e.preventDefault();
                swal_confirm('ยืนยันการทำงาน', 'ต้องการบันทึกแบบไม่มีรายการ?', () => {
                    NoData();
                });
            });
        } );

        const NoData = () => {
            $.post('@Url.Action("SaveNoData")', (data) => {
                swal_success('ทำรายการสำเร็จ');
                setTimeout(() => { window.location = '@Url.Action("Index")';},1500);
            });
        }

        function upload_file() {
            //var files = $('#input_file').prop('files');

            //if (files.length == 0) {
            //    $('#form_upload').addClass('has-error');
            //}

            // Checking whether FormData is available in browser
            if (window.FormData !== undefined) {

                var fileUpload = $("#input_file").get(0);
                var files = fileUpload.files;

                // Check selected file
                if (files.length == 0) {
                    //$('#form_upload').addClass('has-error');
                    swal({
                        title: 'กรุณาเลือกไฟล์ที่ต้องการ!',
                        type: 'error',
                        showCancelButton: false,
                        confirmButtonColor: '#00a65a',
                        confirmButtonText: 'ตกลง',
                        closeOnConfirm: false,
                        closeOnCancel: true
                    });
                } else {
                    $.LoadingOverlay("show",
                        {
                            image: "/Content/img/Spinner-1s-200px.svg",
                            imageAnimation: "",
                            imageColor: "#00aeef"
                        });

                    $('#upload_form').submit();
                }

            } else {
                alert("FormData is not supported.");
            }
        }

        function save() {
            $.LoadingOverlay("show",
                {
                    image: "/Content/img/Spinner-1s-200px.svg",
                    imageAnimation: "",
                    imageColor: "#00aeef"
                });

            $.ajax({
                url: '@Url.Action("Save", "NewAppMP")',
                type: "POST",
                data: {
                    dataKey: '@ViewBag.DataKey'
                },
                success: function (result) {
                    $.LoadingOverlay("hide");

                    console.log(result);

                    swal({
                        title: 'บันทึกข้อมูลเรียบร้อยแล้ว!',
                        type: 'success',
                        showCancelButton: false,
                        confirmButtonColor: '#00a65a',
                        confirmButtonText: 'ตกลง',
                        closeOnConfirm: false,
                        closeOnCancel: true
                    },
                    function() {
                        window.location.href = '@Url.Action("Index", "NewAppMP")';
                    });
                },
                error: function (err) {
                    alert(err.statusText);
                }
            });
        }
    </script>
}